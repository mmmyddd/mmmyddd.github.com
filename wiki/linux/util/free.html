<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-triditional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
    <title>
      Justin's Wiki - Free</title>
    <link rel="alternate" type="application/rss+xml" title="RSS" href="http://mmmyddd.github.io/wiki/res/rss.xml" />
    <link rel="shortcut icon" href="/image/favicon.ico" />
    <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../../res/css/common2.css"/>
<link rel="stylesheet" type="text/css"  charset="utf-8" media="screen" href="../../res/css/screen.css"/>
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="../../res/css/print.css"/>
<!--[if IE]><link rel="stylesheet" type="text/css" charset="utf-8" href="../../res/css/iehacks.css"/>
<![endif]-->
<!--[if lte IE 6]><link rel="stylesheet" type="text/css" charset="utf-8" href="../../res/css/ie6hacks.css"/>
<![endif]-->


    <script type="text/javascript" src="../../res/js/scripts/shCore.js"></script>
    <script type="text/javascript" src="../../res/js/scripts/shBrushCss.js"></script>
    <script type="text/javascript" src="../../res/js/scripts/shBrushJava.js"></script>
    <script type="text/javascript" src="../../res/js/scripts/shBrushPython.js"></script>
    <script type="text/javascript" src="../../res/js/scripts/shBrushXml.js"></script>
    <script type="text/javascript" src="../../res/js/scripts/shBrushPlain.js"></script>
    <script type="text/javascript" src="../../res/js/scripts/shBrushPerl.js"></script>
    <script type="text/javascript" src="../../res/js/scripts/shBrushBash.js"></script>
    <script type="text/javascript" src="../../res/js/scripts/shBrushJScript.js"></script>
    <script type="text/javascript" src="../../res/js/scripts/shBrushCpp.js"></script>
    <script type="text/javascript" src="../../res/js/scripts/shBrushSql.js"></script>
    <script type="text/javascript" src="../../res/js/scripts/shBrushDiff.js"></script>
    <link type="text/css" rel="stylesheet" href="../../res/css/styles/shCore.css"/>
    <link type="text/css" rel="stylesheet" href="../../res/css/styles/shThemeDefault.css"/>
    <script type="text/javascript">
      SyntaxHighlighter.config.clipboardSwf = '../../res/js/scripts/clipboard.swf';
      SyntaxHighlighter.all();
    </script>

    <script type="text/javascript" src="../../res/js/audio-player.js"></script>
    <script type="text/javascript">
      AudioPlayer.setup("../../res/js/audioplayer.swf", {
      width: 290,
      transparentpagebg: "yes"
      });
    </script>

    <script type="text/javascript" src="../../res/js/swfobject.js"></script>
    <script type="text/javascript">
      var media_player = "../..//res/js/player.swf";
    </script>

    <meta name="description" content="Michael Olson, maintainer of Emacs Muse and ERC" />
    <meta name="keywords" content="" />
    <meta name="generator" content="Muse" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript" src="../../res/js/collapsible.js" >
    </script>
  </head>

  <body>
    <a name="top"></a>
    <div class="banner" id="banner">
      <div class="logo">
        <a href="/wiki/./index.html" style="text-decoration: none;">
          <img src="/image/wiki-logo.png" alt="Justin's Wiki" />
        </a>
      </div>
      <form action="http://www.google.com/cse" id="cse-search-box">
        <span id="gsearch">
          &nbsp;
        </span>
        <a href="/wiki/res/rss.xml">
          <img src="/image/rss.png" style="border:0pt none;width:47px;height:17px;top:0px;" alt="rss" />
        </a>
      </form>
    </div>

    <div class="navbar" id="navbar">
      <div>
        &nbsp;
        <a href="/">Home</a>
        &#187; 
<a href="/wiki/./index.html">学习笔记</a>
&#187; 
<a href="/wiki/linux/index.html">Linux Programming</a>
&#187; 
<a href="/wiki/linux/util/index.html">Linux Command Tools</a>

      </div>
      <ul>
        <li><a href="/blog-res/blog?/about">About</a> </li>
        &nbsp; :: &nbsp;
        <li><a href="/blog-res/blog">Blog</a></li>
        &nbsp; :: &nbsp;
        <li><a href="/wiki/./index.html">Wiki</a></li>
        &nbsp; :: &nbsp;
        <li><a href="/article/index.html">Article</a></li>
        &nbsp; :: &nbsp;
        <li><a href="/blog-res/blog?/bookmarks">Bookmarks</a></li>
        &nbsp; :: &nbsp;
        <li><a href="/blog-res/blog?/projects">Projects</a></li>
        &nbsp; :: &nbsp;
        <li><a href="/blog-res/blog?/Albums">Albums</a></li>
        &nbsp;&nbsp;
      </ul>
    </div>
  <!-- Page published by Emacs Muse begins here -->
  <div class="container" id="container">

    <!--navigation-->
    <div class="topic" id="topic">
      <ul id="outer">
        <!-- Wiki projects tree -->
        Loading ...
      </ul>
    </div>

    <!-- collapsible arrow -->
    <div class="muse-content" id="muse-content" >
      <!-- collapsible splitter -->
      <div id="collapsible"></div>
      <div class="padding">&nbsp;</div>
      <!--muse generated -->
      <div class="pretty-title">
        Free
      </div>
<blockquote>
<p class="quoted">free - Display amount of free and used memory in the system</p>
</blockquote>


<blockquote>
<p class="quoted">free displays the total amount of free and used physical and
swap  memory in  the system, as well as  the buffers used by
the kernel.</p>
</blockquote>

<p><strong>The shared  memory column should be ignored; it is obsolete.</strong></p>

<pre class="example">
free [-b|-k|-m|-g] [-c count] [-l] [-o] [-t] [-s delay] [-V]
</pre>



<h2><span class="toplink"><a href="#top"><img src="/wiki/res/image/btn_top.png"></a></span>Options</h2>

<h3><span class="toplink"><a href="#top"><img src="/wiki/res/image/btn_top.png"></a></span>-V 显示版本号码</h3>

<p><em>procps</em> 软件包包含了vmstat, free等一些工具：</p>

<pre class="example">
justin@Justin:~$ free -V
procps version 3.2.8
</pre>


<h3><span class="toplink"><a href="#top"><img src="/wiki/res/image/btn_top.png"></a></span>[-b|-k|-m|-g] 控制显示单位</h3>

<ul>
<li>b,-k,-m,-g show output in bytes, KB, MB, or GB</li>
</ul>

<p>默认是 <code>-k</code></p>


<h3><span class="toplink"><a href="#top"><img src="/wiki/res/image/btn_top.png"></a></span>-s -c 重复显示</h3>

<ul>
<li>c count
<blockquote>
<p class="quoted">Display  the  result  count  times.   Requires  the  -s
option. <strong>default is infinity</strong></p>
</blockquote></li>

<li>s   Continuously   display   the   result   delay   seconds
<blockquote>
<p class="quoted">apart.  You  may actually  specify  any floating  point
number  for delay,  usleep(3)  is used  for microsecond
resolution delay times.</p>
</blockquote></li>
</ul>


<h3><span class="toplink"><a href="#top"><img src="/wiki/res/image/btn_top.png"></a></span>no options</h3>

<pre class="example">
justin@Justin:~$ free
             total       used       free     shared    buffers     cached
Mem:       1010128     995372      14756          0      45612     126860
-/+ buffers/cache:     822900     187228
Swap:       979956      49072     930884
</pre>

<p>Low Free Memory is not always bad thing:</p>

<p>It can be discouraging to see very little <em>free memory</em> in a
system because of the cache and buffer usage, but this is
not necessarily a bad thing.</p>

<p>By default, Linux tries to use as much of your memory as
possible. This is good. If Linux detects any free memory, it
caches applications and data in the free memory to speed up
future accesses. Because it is usually a few orders of
magnitude faster to access things from memory rather than
disk, this can dramatically improve overall performance.
When the system needs the cache memory for more important
things, the cache memory is erased and given to the
system. Subsequent access to the object that was previously
cached has to go out to disk to be filled.</p>

<blockquote>
<p class="quoted"><strong>total = used + free</strong></p>
</blockquote>

<blockquote>
<p class="quoted"><strong>can_be_used = free + buffer + cache</strong></p>
</blockquote>

<p>第2行：
-/+ buffers/cache的意思相当于：
-buffers/cache 的内存数：1397032 (等于第1行的 used - buffers - cached)
+buffers/cache 的内存数: 2752124 (等于第1行的 free + buffers + cached)</p>

<h4><span class="toplink"><a href="#top"><img src="/wiki/res/image/btn_top.png"></a></span>Metrics</h4>

<p class="first">can_be_used / total mem (physical) &gt; 70% (enough)</p>

<p>can_be_used / total mem (physical) &lt; 20% (lack of memory)</p>

<p>can_be_used / total mem (physical) &gt; 20%  &amp;&amp; &lt; 70% (不影响系统性能)</p>




<h3><span class="toplink"><a href="#top"><img src="/wiki/res/image/btn_top.png"></a></span>-l</h3>

<ul>
<li>l   Show detailed low and high memory statistics.</li>
</ul>

<pre class="example">
             total       used       free     shared    buffers     cached
Mem:       1010128     997720      12408          0      43040     117964
Low:        891400     879096      12304
High:       118728     118624        104
-/+ buffers/cache:     836716     173412
Swap:       979956      51520     928436
</pre>

<p><strong>Low＋High=Mem</strong></p>


<h4><span class="toplink"><a href="#top"><img src="/wiki/res/image/btn_top.png"></a></span>Low vs High Memory</h4>
Low
The total amount of low memory or memory directly accessible by the kernel.

<p>High
The total amount of high memory or memory not directly accessible by the kernel.</p>


<p>High Versus Low Memory
===========================</p>

<p>For 64bit processor it does not matter because they can
directly address additional memory that is available in
current system</p>

<p>For 32-bit processors (for example, IA32) with 1 GB or more
of physical of memory, Linux must manage the physical memory
as high and low memory. The high memory is not directly
accessible by the Linux kernel and must be mapped into the
low-memory range before it can be used.</p>


<p>15.1.3. High and Low Memory</p>

<p>The difference between logical and kernel virtual addresses is highlighted on 32-bit systems that are equipped with large amounts of memory. With 32 bits, it is possible to address 4 GB of memory. Linux on 32-bit systems has, until recently, been limited to substantially less memory than that, however, because of the way it sets up the virtual address space.</p>

<p>The kernel (on the x86 architecture, in the default configuration) splits the 4-GB virtual address space between user-space and the kernel; the same set of mappings is used in both contexts. A typical split dedicates 3 GB to user space, and 1 GB for kernel space.<sup><a class="footref" name="fnr.1" href="#fn.1">1</a></sup> The kernel's code and data structures must fit into that space, but the biggest consumer of kernel address space is virtual mappings for physical memory. The kernel cannot directly manipulate memory that is not mapped into the kernel's address space. The kernel, in other words, needs its own virtual address for any memory it must touch directly. Thus, for many years, the maximum amount of physical memory that could be handled by the kernel was the amount that could be mapped into the kernel's portion of the virtual address space, minus the space needed for the kernel code itself. As a result, x86-based Linux systems could work with a maximum of a little under 1 GB of physical memory.</p>

<blockquote>
<p class="quoted"><sup><a class="footref" name="fnr.1" href="#fn.1">1</a></sup> Many non-x86 architectures are able to efficiently do without the kernel/user-space split described here, so they can work with up to a 4-GB kernel address space on 32-bit systems. The constraints described in this section still apply to such systems when more than 4 GB of memory are installed, however.</p>
</blockquote>

<p>In response to commercial pressure to support more memory while not breaking 32-bit application and the system's compatibility, the processor manufacturers have added &quot;address extension&quot; features to their products. The result is that, in many cases, even 32-bit processors can address more than 4 GB of physical memory. The limitation on how much memory can be directly mapped with logical addresses remains, however. Only the lowest portion of memory (up to 1 or 2 GB, depending on the hardware and the kernel configuration) has logical addresses;<sup><a class="footref" name="fnr.2" href="#fn.2">2</a></sup> the rest (high memory) does not. Before accessing a specific high-memory page, the kernel must set up an explicit virtual mapping to make that page available in the kernel's address space. Thus, many kernel data structures must be placed in low memory; high memory tends to be reserved for user-space process pages.</p>

<blockquote>
<p class="quoted"><sup><a class="footref" name="fnr.2" href="#fn.2">2</a></sup> The 2.6 kernel (with an added patch) can support a &quot;4G/4G&quot; mode on x86 hardware, which enables larger kernel and user virtual address spaces at a mild performance cost.</p>
</blockquote>

<p>The term &quot;high memory&quot; can be confusing to some, especially since it has other meanings in the PC world. So, to make things clear, we'll define the terms here:</p>

<p>Low memory</p>

<blockquote>
<p class="quoted">Memory for which logical addresses exist in kernel space. On almost every system you will likely encounter, all memory is low memory.
High memory</p>
</blockquote>

<blockquote>
<p class="quoted">Memory for which logical addresses do not exist, because it is beyond the address range set aside for kernel virtual addresses.</p>
</blockquote>

<p>On i386 systems, the boundary between low and high memory is
usually set at just under 1 GB, although that boundary can
be changed at kernel configuration time. This boundary is
not related in any way to the old 640 KB limit found on the
original PC, and its placement is not dictated by the
hardware. It is, instead, a limit set by the kernel itself
as it splits the 32-bit address space between kernel and
user space.</p>

<p>We will point out limitations on the use of high memory as we come to them in this chapter.</p>



<h3><span class="toplink"><a href="#top"><img src="/wiki/res/image/btn_top.png"></a></span>-o</h3>

<ul>
<li>o   Display the  output in old format,  the only difference
<blockquote>
<p class="quoted">being  this  option will  disable  the  display of  the
<strong>&quot;buffer adjusted&quot;</strong> line.</p>
</blockquote></li>
</ul>

<pre class="example">
justin@Justin:~$ free -o
             total       used       free     shared    buffers     cached
Mem:       1010128     993748      16380          0      45012     122336
Swap:       979956      50008     929948
</pre>


<h3><span class="toplink"><a href="#top"><img src="/wiki/res/image/btn_top.png"></a></span>-t</h3>


<ul>
<li>t   Display a line showing the column totals.</li>
</ul>

<pre class="example">
             total       used       free     shared    buffers     cached
Mem:       1010128     993252      16876          0      44960     122336
-/+ buffers/cache:     825956     184172
Swap:       979956      50008     929948
Total:     1990084    1043260     946824
</pre>


<p>如果感兴趣可以进一步参考文件/proc/meminfo，free命令就是根据它
的信息生成的。free命令的源码可从procps-xxx-.src.rpm获取，xxx
为版本号，比如procps-3.2.3-5.3.src.rpm。</p>

<p>FILES
<blockquote>
<p class="quoted">/proc/meminfo memory information</p>
</blockquote>



<!-- Page published by Emacs Muse ends here -->
<!-- disqus -->
<div id="disqus_thread" style="margin-top:200px"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'justinswebsite'; // Required - Replace example with your forum shortname
    var disqus_identifier = 'wiki:linux_util_free';
    var disqus_title = "Justin's Wiki - Free";
    var disqus_url = 'http://mmmyddd.github.io/wiki/linux/util/free.html';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">Wiki comments powered by <span class="logo-disqus">Disqus</span></a>

</div><!--end of muse-content -->
</div><!--end of container-->

<div style="clear:both;margin-top:5px;">&nbsp;</div>

<div class="navfoot">
  <hr class="footer-splitter" />
  <table width="100%" summary="Footer navigation">
    <col width="33%" />
    <col width="34%" />
    <col width="33%" />
    <tr>
      <td width="33%" align="left" valign="top" style="line-height:175%">
        <a href="/">
          <img alt="Home" style="border:0;width:230px;height:50px;top:0px;"
               src="/image/test.png" />
        </a>
        <br />
        <span class="footdate">Contact:</span>
        <a href="https://github.com/mmmyddd">
          mmmyddd@github
        </a>

        <br />
        <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1278589705'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/z_stat.php%3Fid%3D1278589705%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));</script>
        <span class="footdate">2009-<span class="thisyear">2019</span> © CopyLeft Contributed</span>
            <script type="text/javascript">
              var date = new Date();
              var year = date.getFullYear();
              document.getElementsByClassName("thisyear")[0].innerHTML=year;
            </script>
      </td>
      <td width="34%" align="center" valign="top">
      </td>
      <td width="33%" align="right" valign="bottom" style="line-height: 175%">
        <table style="margin: 0 0;padding: 0 0;">
          <tr><td colspan="2" align="right">
            <!-- GoStats JavaScript Based Code -->
            <script type="text/javascript" src="http://gostats.com/js/counter.js"></script>
            <script type="text/javascript">_gos='gostats.com';_goa=745573;
              _got=6;_goi=42;_gol='web site analytics';_GoStatsRun();</script>
            <noscript>
              <a target="_blank" title="web site analytics"
                 href="http://gostats.com">
                <img alt="web site analytics"
                     src="http://gostats.com/bin/count/a_745573/t_6/i_42/counter.png"
                     style="border-width:0" />
              </a>
            </noscript>
            <!-- End GoStats JavaScript Based Code -->
          </td></tr>
          <tr style="margin: 0 0;padding: 0 0;">
            <td style="margin: 0 0;padding: 0 0;">
              <a href="http://validator.w3.org/check?uri=referer"
                 style="text-decoration: none;">
                <img style="border:0;width:88px;height:31px;top:0px;"
                     src="../../res/image/valid-xhtml10-blue.png"
                     alt="Valid XHTML 1.0!"/>
              </a>
            </td>
            <td>
              <a href="http://jigsaw.w3.org/css-validator/check/referer"
                 style="text-decoration: none;">
                <img style="border:0;width:88px;height:31px;top:0px;"
                     src="../../res/image/valid-css-blue.png"
                     alt="Valid CSS!" />
              </a>
            </td>
          </tr>
        </table>
        <span class="footdate">
          Last updated 1月. 29, 2020
        </span>
        <br />
        [ <a href="#top">Top</a> | <a href="/wiki/linux/util/index.html">Up</a> | <a href="/wiki/./index.html">Dir</a> | <a href="/">Home</a> ]
      </td>
    </tr>
  </table>
</div>
<div id="collapsible-arrow" style="display:none;"></div>
</body>
<script language="javascript">
  getContent("../../res/topic.html", "linux_util_free");
  //afterload();
  fillsearch();
</script>
</html>
